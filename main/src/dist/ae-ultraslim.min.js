!function(a){"use strict";var b=window.æ||new a;window.æ=window.ultraslim=b}(function(){this.templates={};var a="ae-",b="{{",c={},d=this;this.templates.load=function(a){var b=this,c=new XMLHttpRequest,d="string"==typeof a?a:a.url,e="object"==typeof a?a:void 0;if(this.cache[d]){var f=this.cache[d];return void(b.onDone&&b.onDone instanceof Function&&b.onDone(f,e))}c.addEventListener("load",function(){var a=c.responseText;if(c.status<300){if(b.onLoad&&b.onLoad instanceof Function){var f=b.onLoad(a);a=f?f:a}b.cache[d]=a,b.onDone&&b.onDone instanceof Function&&b.onDone(a,e)}else b.onError&&b.onError instanceof Function&&b.onError(e)}),c.addEventListener("error",function(){b.onError&&b.onError instanceof Function&&b.onError(e)}),c.open("GET",d),c.send()},this.templates.onLoad=void 0,this.templates.onError=void 0,this.templates.onDone=function(a){return a},this.templates.cache={},this.service=function(a,b,c){function d(a,b){a&&a.onSuccess&&a.onSuccess instanceof Function?a.onSuccess(b.status,b):i.onSuccess&&i.onSuccess(b.status,b)}function e(a,b){a&&a.onDone&&a.onDone instanceof Function?a.onDone(b.status,b):i.onDone&&i.onDone(b)}function f(a,b){a&&a.onError&&a.onError instanceof Function?a.onError(b.status,b):i.onError&&i.onError(b.status,b)}function g(a,b){a&&a.onBeforeSend&&a.onBeforeSend instanceof Function?a.onBeforeSend(b):i.onBeforeSend&&i.onBeforeSend(b)}function h(a,b){b.status<400?d(a,b):f(a,b),e(a,b)}if(void 0===a||"object"!=typeof a||"object"!=typeof a)throw new Error("o is not an object.");if(void 0===c||"object"!=typeof c)throw new Error("No configuration object.");if(void 0!==c.onError&&"function"!=typeof c.onError)throw new Error("onError-handler is not a function.");if(void 0!==c.onBeforeSend&&"function"!=typeof c.onBeforeSend)throw new Error("onBeforeSend-handler is not a function.");if(void 0!==c.onDone&&"function"!=typeof c.onDone)throw new Error("onDone-handler is not a function.");a.hasOwnProperty(b)||(a[b]=[],this.object(a));var i={},j="string"==typeof c?c:c.url;return i={},i.onError="function"==typeof c.onError?c.onError:void 0,i.onBeforeSend="function"==typeof c.onBeforeSend?c.onBeforeSend:void 0,i.onSuccess="function"==typeof c.onSuccess?c.onSuccess:void 0,i.onDone="function"==typeof c.onDone?c.onDone:void 0,i.load=function(c){var d=new XMLHttpRequest;d.addEventListener("load",function(e){if(d.status<400){var f=JSON.parse(d.responseText);a[b]=f}h(c,d)}),d.open("GET",j),g(c,d),d.send()},i.delete=function(a,b){var c=new XMLHttpRequest;c.addEventListener("load",function(){h(b,c)}),c.open("DELETE",j+"/"+a),c.setRequestHeader("Content-Type","application/json"),g(b,c),c.send()},i.create=function(a,b){var c=new XMLHttpRequest;c.addEventListener("load",function(){h(b,c)}),c.open("POST",j),c.setRequestHeader("Content-Type","application/json"),g(b,c),c.send(JSON.stringify(a))},i.save=function(a,b){var c=new XMLHttpRequest;c.addEventListener("load",function(){h(b,c)}),c.open("PUT",j),c.setRequestHeader("Content-Type","application/json"),g(b,c),c.send(JSON.stringify(a))},i},this.object=function(a){function b(a,b){return function(){return a[b]}}function c(b,c){return function(e){Array.isArray(e)?(d.object(e),e.push=function(b){if(Array.prototype.push.call(e,b),f[c])for(var d in f[c])f[c][d](a,null,e)}):"object"==typeof e&&d.object(e);var g=b[c];if(b[c]=e,f[c])for(var h in f[c])f[c][h](a,g,e)}}var d=this,e=[],f={};if(a){f.size=function(){var a=0,b=Object.getOwnPropertyNames(f);for(var c in b)"length"!==b[c]&&"size"!==b[c]&&a++;return a};for(var g in a)a[g]instanceof Function||"http"===g&&g.get&&g.put&&g.delete&&g.post||(e[g]=a[g],delete a[g],Object.defineProperty(a,g,{get:b(e,g),set:c(e,g),enumerable:!0,configurable:!0}),Array.isArray(a[g])?(this.object(a[g]),a[g].push=function(b){if(Array.prototype.push.call(a[g],b),f[g]){d.object(b);for(var c in f[g])f[g][c](a,null,b)}}):"object"==typeof a[g]&&this.object(a[g]));a.addChangeListener,a.addChangeListener=function(a,b){f[a]||(f[a]=[]),f[a].push(b)},a.getChangeListeners=function(){return f},a.clearChangeListeners=function(){f={},f.size=function(){var a=0,b=Object.getOwnPropertyNames(f);for(var c in b)"length"!==b[c]&&"size"!==b[c]&&a++;return a}},a.fireChangeListeners=function(){var b=Object.getOwnPropertyNames(f);for(var c in b)if("length"!==b[c]&&"size"!==b[c]&&f[b[c]].length)for(var d=0;d<f[b[c]].length;d++)"function"==typeof f[b[c]][d]&&f[b[c]][d](a,a[b[c]],a[b[c]])};for(var h in a)"object"==typeof a[h]&&a.addChangeListener(h,function(a,b,c){if(b&&b.getChangeListeners){c.addChangeListener||d.object(c);var e=b.getChangeListeners();for(var f in e)if("size"!==f&&e[f].length)for(var g=0;g<e[f].length;g++)c.addChangeListener(f,e[f][g])}})}};var e=function(a){this.controller=void 0,this.init(a)};e.prototype.init=function(a){if(this.elementName=a,this.element=document.querySelector(this.elementName),void 0===this.element)throw new Error("Element not found for selector: "+a);var b=this;d.templates.onDone=function(a,c){var e=c&&c.controller&&c.controller.model?c.controller.model:void 0;e&&"object"==typeof e&&d.object(e);var f=c&&c.controller?c.controller:void 0;b.onLoad(a,e,f)}},e.prototype.show=function(a,b){this.controller=b,b&&b.model&&"object"==typeof b.model&&d.object(b.model),d.templates.load(b?{url:a,controller:b}:a)},e.prototype.onLoad=function(a,b,c){if(void 0!==b&&(a=this.render(a,b,c)),a instanceof NodeList){this.getEl().innerHTML="";for(var d=0;d<a.length;d++)this.getEl().appendChild(a.item(d))}else this.getEl().innerHTML=a;c&&"function"==typeof c.init&&c.init(this.getEl())},e.prototype.onError=function(a){},e.prototype.process=function(c,d,e){var f,g=this,h=function(c){if(1===c.nodeType){for(var e=c.parentNode,i=0;i<c.attributes.length;i++)f=c.attributes.item(i),f.value.indexOf(b)>-1&&(f.value=g.replace(f.value,d));for(var j=0;j<c.attributes.length;j++)if(f=c.attributes.item(j),f.name===a+"repeat"){if(d[f.value]){var k=d[f.value],l=[];if(k.length>0){for(var m=0;m<k.length;m++){var n=k[m],o=c.cloneNode(!0);o.attributes.removeNamedItem(a+"repeat"),g.process(o,n),l.push(o)}for(var p=0;p<l.length;p++)c.parentNode.insertBefore(l[p],c)}d.addChangeListener&&d.addChangeListener(f.value,function(b,d,f){if(e.innerHTML="",f.length>0)for(var h=0;h<f.length;h++){var i=f[h],j=c.cloneNode(!0);j.attributes.removeNamedItem(a+"repeat"),g.process(j,i),e.appendChild(j)}})}c.parentNode.removeChild(c)}else if(f.name===a+"click")c.onclick=g.createHandler(c,"click",f.value);else if(f.name===a+"bind"){var q=f.value,r=new Function("return "+q).call(g);if(c.value=r,q.lastIndexOf(".")>0){var s=q.substr(0,q.lastIndexOf(".")),t=new Function("return "+s).call(g);c.onchange=function(a){t[q.substr(q.lastIndexOf(".")+1)]=c.value}}g.createListener(q,c)}}3===c.nodeType&&c.nodeValue.indexOf(b)>-1&&(c.nodeValue=g.replace(c.nodeValue,d),c.nodeValue.indexOf("<b>")>-1&&(c.innerHTML=c.nodeValue));for(var u=0;u<c.childNodes.length;u++)h(c.childNodes.item(u))};if(c instanceof NodeList)for(var i=0;i<c.length;i++)h(c.item(i));else{if(!(c instanceof Node))throw new Error("Element must be a DOM Node or NodeList instance.");h(c)}},e.prototype.createHandler=function(a,b,c){var d=this;return function(){new Function(c).call(d)}},e.prototype.createListener=function(a,b){var c=this;if(a.lastIndexOf(".")>0){var d=a.substr(0,a.lastIndexOf(".")),e=a.substr(a.lastIndexOf(".")+1),f=new Function("return "+d).call(c);if(f&&f.addChangeListener&&f.addChangeListener instanceof Function&&f.addChangeListener(e,function(a,c,d){b.value=d}),d.lastIndexOf(".")>0&&"this.controller"!==d&&"this.controller.model"!==d){var g=d.substr(0,d.lastIndexOf(".")),h=new Function("return "+g).call(c);if(h&&h.addChangeListener&&h.addChangeListener instanceof Function){var i=d.substr(d.lastIndexOf(".")+1);h.addChangeListener(i,function(a,c,d){d?b.value=d[e]:b.value=null,b.onchange=function(){d[e]=b.value}})}}}},e.prototype.filter=function(a,b){switch(a){case"Date":if(!b||b.trim&&""===b.trim())return"";var c=new Date;return c.setTime(b),c.toLocaleDateString("de-DE");default:return this.controller.hasOwnProperty(a)&&this.controller[a]instanceof Function?this.controller[a](b):b}},e.prototype.render=function(c,d,e){if(!d)return this.replace(c,{});if(c.indexOf(a)>-1){var f=document.createElement("DIV");return f.innerHTML=c,this.process(f,d,e),f.childNodes}return c.indexOf(a)===-1?(c.indexOf(b)>-1&&(c=this.replace(c,d)),c):void 0},e.prototype.replace=function(a,b){if(""===a.trim())return a;var c=a,d=a.match(/(\{{.+?\}})/g);if(d&&d.length>0)for(var e=0;e<d.length;e++){var f,g=d[e],h=g.substr(2,g.length-4);h.indexOf("|")>-1&&(h=h.substr(0,h.indexOf("|")),f=g.substr(g.indexOf("|")+1,g.length-3-g.indexOf("|")));var i="";b.hasOwnProperty(h)?(i=b[h]?b[h]:"",f&&(i=this.filter(f,i)),c=c.replace(g,i)):h.indexOf(".")>-1&&(i=new Function("try { return this."+h+'; } catch (ex) { return "{{'+h+'}}";} ').call(b),c=c.replace(g,i))}return c},e.prototype.getEl=function(){if(this.element=document.querySelector(this.elementName),void 0===this.element)throw new Error("Element not found for selector: "+name);return this.element},this.view=function(a){return c[a]||(c[a]=new e(a)),c[a]};var f=function(a){var b=this;this.root=a.root||null,this.useHash=a.useHash||!1,this.routes={},this.defaultHandler=void 0,window.addEventListener("DOMContentLoaded",function(){b.init()})};f.prototype.default=function(a){if(!(a instanceof Function))throw new Error("The default route handler must be a function.");this.defaultHandler=a},f.prototype.init=function(){var a=this;window.onhashchange=function(b){a.onhashchange.apply(a,[b])},window.onload=function(b){a.onhashchange.apply(a,[b])}},f.prototype.on=function(a,b){if(!(b instanceof Function))throw new Error("Handler needs to be a function.");this.routes[a]=b},f.prototype.onError=function(a){if(!(a instanceof Function))throw new Error("The default error handler must be a function.");this.errorHandler=a},f.prototype.onhashchange=function(a){var b=window.location.href,c="";"load"===a.type?b.indexOf("#")>0&&(c=b.substr(b.indexOf("#")+1)):a.newURL.indexOf("#")>0&&(c=a.newURL.substr(a.newURL.indexOf("#")+1)),this.navigate(c)},f.prototype.navigate=function(a){""===a&&(a="/");var b,c=this.routes[a];if(this.params=b,void 0===c)for(var d in this.routes)if(d.indexOf(":")>0){var e=d.split("/"),f=a.split("/");try{if(f.length===e.length){b={},this.params=b;for(var g=0;g<e.length;g++)if(":"===e[g].charAt(0))b[e[g].substr(1)]=f[g];else if(f[g]!==e[g])throw b=void 0,new Error("not matching!");c=this.routes[d];break}}catch(a){continue}}if(void 0===c&&(c=this.defaultHandler),void 0===c){if(this.errorHandler)return void this.errorHandler({url:a});throw new Error("No handler for route: "+a)}if(!(c instanceof Function))throw new Error("Handler is not a function.");c(b?{params:b}:void 0)},this.router=function(a,b){return new f({root:a,useHash:b})}});
//# sourceMappingURL=ae-ultraslim.map