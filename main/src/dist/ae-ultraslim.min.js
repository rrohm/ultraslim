!function(e){"use strict";e=window.æ||new e,window.æ=window.ultraslim=e}(function(){this.templates={};var attrPrefix="ae-",expPrefix="{{",expSuffix="}}",views={},me=this;this.templates.load=function(e){var t=this,n=new XMLHttpRequest,o="string"==typeof e?e:e.url,r="object"==typeof e?e:void 0;this.cache[o]?(e=this.cache[o],t.onDone&&t.onDone instanceof Function&&t.onDone(e,r)):(n.addEventListener("load",function(){var e=n.responseText;n.status<300?(t.onLoad&&t.onLoad instanceof Function&&(e=t.onLoad(e)||e),t.cache[o]=e,t.onDone&&t.onDone instanceof Function&&t.onDone(e,r)):t.onError&&t.onError instanceof Function&&t.onError(r)}),n.addEventListener("error",function(){t.onError&&t.onError instanceof Function&&t.onError(r)}),n.open("GET",o),n.send())},this.templates.onLoad=void 0,this.templates.onError=void 0,this.templates.onDone=function(e){return e},this.templates.cache={},this.service=function(r,i,e){if(void 0===r||"object"!=typeof r||"object"!=typeof r)throw new Error("o is not an object.");if(void 0===e||"object"!=typeof e)throw new Error("No configuration object.");if(void 0!==e.onError&&"function"!=typeof e.onError)throw new Error("onError-handler is not a function.");if(void 0!==e.onBeforeSend&&"function"!=typeof e.onBeforeSend)throw new Error("onBeforeSend-handler is not a function.");if(void 0!==e.onDone&&"function"!=typeof e.onDone)throw new Error("onDone-handler is not a function.");r.hasOwnProperty(i)||(r[i]=[],this.object(r));var a={};function s(e,t){e&&e.onBeforeSend&&e.onBeforeSend instanceof Function?e.onBeforeSend(t):a.onBeforeSend&&a.onBeforeSend(t)}function c(e,t){var n,o;t.status<400?(o=t,(n=e)&&n.onSuccess&&n.onSuccess instanceof Function?n.onSuccess(o.status,o):a.onSuccess&&a.onSuccess(o.status,o)):(n=t,(o=e)&&o.onError&&o.onError instanceof Function?o.onError(n.status,n):a.onError&&a.onError(n.status,n)),e&&e.onDone&&e.onDone instanceof Function?e.onDone(t.status,t):a.onDone&&a.onDone(t)}return(a={}).url="string"==typeof e?e:e.url,a.dataProp=void 0!==e.dataProp?e.dataProp:void 0,a.onError="function"==typeof e.onError?e.onError:void 0,a.onBeforeSend="function"==typeof e.onBeforeSend?e.onBeforeSend:void 0,a.onSuccess="function"==typeof e.onSuccess?e.onSuccess:void 0,a.onDone="function"==typeof e.onDone?e.onDone:void 0,a.load=function(n){this.url;var o=new XMLHttpRequest;o.addEventListener("load",function(e){var t;o.status<400&&(t=JSON.parse(o.responseText),r[i]=void 0!==a.dataProp?t[a.dataProp]:t),c(n,o)}),o.open("GET",this.url),o.setRequestHeader("X-Requested-With","XMLHttpRequest"),s(n,o),o.send()},a.delete=function(e,t){this.url;var n=new XMLHttpRequest;n.addEventListener("load",function(){c(t,n)}),n.open("DELETE",this.url+"/"+e),n.setRequestHeader("Content-Type","application/json"),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),s(t,n),n.send()},a.create=function(e,t){this.url;var n=new XMLHttpRequest;n.addEventListener("load",function(){c(t,n)}),n.open("POST",this.url),n.setRequestHeader("Content-Type","application/json"),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),s(t,n),n.send(JSON.stringify(e))},a.save=function(e,t,n){this.url;var n=n||e.id||void 0,o=new XMLHttpRequest;o.addEventListener("load",function(){c(t,o)}),o.open("PUT",this.url+"/"+n),o.setRequestHeader("Content-Type","application/json"),o.setRequestHeader("X-Requested-With","XMLHttpRequest"),s(t,o),o.send(JSON.stringify(e))},a},this.object=function(i){var a=this,e=[],s={};if(i){for(var n in s.size=function(){var e,t=0,n=Object.getOwnPropertyNames(s);for(e in n)"length"!==n[e]&&"size"!==n[e]&&t++;return t},i)i[n],i[n]instanceof Function||"http"===n&&n.get&&n.put&&n.delete&&n.post||(e[n]=i[n],delete i[n],Object.defineProperty(i,n,{get:function(e,t){return function(){return e[t]}}(e,n),set:function(o,r){return function(n){Array.isArray(n)?(a.object(n),n.push=function(e){if(Array.prototype.push.call(n,e),s[r])for(var t in s[r])s[r][t](i,null,n)}):"object"==typeof n&&a.object(n);var e=o[r];if(o[r]=n,s[r])for(var t in s[r])s[r][t](i,e,n)}}(e,n),enumerable:!0,configurable:!0}),Array.isArray(i[n])?(this.object(i[n]),i[n].push=function(e){if(i[n],Array.prototype.push.call(i[n],e),s[n])for(var t in a.object(e),s[n])s[n][t](i,null,e)}):"object"==typeof i[n]&&this.object(i[n]));for(var t in i.addChangeListener,i.addChangeListener=function(e,t){s[e]||(s[e]=[]),s[e].push(t)},i.getChangeListeners=function(){return s},i.clearChangeListeners=function(){s={size:function(){var e,t=0,n=Object.getOwnPropertyNames(s);for(e in n)"length"!==n[e]&&"size"!==n[e]&&t++;return t}}},i.fireChangeListeners=function(){var e,t=Object.getOwnPropertyNames(s);for(e in t)if("length"!==t[e]&&"size"!==t[e]&&s[t[e]].length)for(var n=0;n<s[t[e]].length;n++)"function"==typeof s[t[e]][n]&&s[t[e]][n](i,i[t[e]],i[t[e]])},i)"object"==typeof i[t]&&i.addChangeListener(t,function(e,t,n){if(t&&t!==n&&t.getChangeListeners){n.addChangeListener||a.object(n);var o,r=t.getChangeListeners();for(o in r)if("size"!==o&&r[o].length)for(var i=0;i<r[o].length;i++)n.addChangeListener(o,r[o][i])}})}};var View=function(e){this.controller=void 0,this.init(e)};View.prototype.init=function(e){if(this.elementName=e,this.element=document.querySelector(this.elementName),void 0===this.element)throw new Error("Element not found for selector: "+e);var o=this;me.templates.onDone=function(e,t){var n=t&&t.controller&&t.controller.model?t.controller.model:void 0;n&&"object"==typeof n&&me.object(n),t=t&&t.controller?t.controller:void 0,o.onLoad(e,n,t)}},View.prototype.show=function(e,t){(this.controller=t)&&t.model&&"object"==typeof t.model&&(t.model,me.object(t.model)),me.templates.load(t?{url:e,controller:t}:e)},View.prototype.onLoad=function(e,t,n){if((e=void 0!==t?this.render(e,t,n):e)instanceof NodeList){this.getEl().innerHTML="";for(var o=0;o<e.length;o++)this.getEl().appendChild(e.item(o))}else this.getEl().innerHTML=e,this.process(this.getEl(),t,n);n&&"function"==typeof n.init&&n.init(this.getEl())},View.prototype.onError=function(e){},View.prototype.process=function(e,w,t){var g,m=this,x=function(a){if(1===a.nodeType){for(var s=a.parentNode,e=0;e<a.attributes.length;e++)-1<(g=a.attributes.item(e)).value.indexOf(expPrefix)&&(g.value=m.replace(g.value,w));for(var t,n,o,r=0;r<a.attributes.length;r++)if((g=a.attributes.item(r)).name===attrPrefix+"repeat"){if(w[g.value]){var i=w[g.value],c=[];if(0<i.length){for(var u=0;u<i.length;u++){var f=i[u],d=a.cloneNode(!0);d.attributes.removeNamedItem(attrPrefix+"repeat"),m.process(d,f),c.push(d)}for(var l=0;l<c.length;l++)a.parentNode.insertBefore(c[l],a)}w.addChangeListener&&w.addChangeListener(g.value,function(e,t,n){if(s.innerHTML="",0<n.length)for(var o=0;o<n.length;o++){var r=n[o],i=a.cloneNode(!0);i.attributes.removeNamedItem(attrPrefix+"repeat"),m.process(i,r),s.appendChild(i)}})}a.parentNode.removeChild(a)}else g.name===attrPrefix+"click"?(g.value,a.onclick=m.createHandler(a,"click",g.value)):g.name===attrPrefix+"dblclick"?(g.value,a.ondblclick=m.createHandler(a,"dblclick",g.value)):g.name===attrPrefix+"bind"?(g.value,t=g.value,n=new Function("return "+t).call(m),"checkbox"===a.type?a.checked=!0===n:a.value=n,0<t.lastIndexOf(".")&&(n=t.substr(0,t.lastIndexOf(".")),o=new Function("return "+n).call(m),a.onchange=function(e){"checkbox"===a.type?o[t.substr(t.lastIndexOf(".")+1)]=!0===a.checked:o[t.substr(t.lastIndexOf(".")+1)]=a.value}),m.createListener(t,a)):g.name===attrPrefix+"model"&&(g.value,a.textContent=new Function("return "+g.value).call(m),m.createTextBinding(g.value,a))}var h,p;3===a.nodeType&&-1<a.nodeValue.indexOf(expPrefix)&&(-1<(h=m.replace(a.nodeValue,w)).indexOf("<p>")||-1<h.indexOf("<i>")||-1<h.indexOf("<strong>")||-1<h.indexOf("<br>")||-1<h.indexOf("<div>")||-1<h.indexOf("<h1>")||-1<h.indexOf("<h2>")||-1<h.indexOf("<h3>")||-1<h.indexOf("<h4>")||-1<h.indexOf("<h5>")||-1<h.indexOf("<h6>")?((p=document.createElement("span")).innerHTML=h,a.replaceWith(p)):a.nodeValue=h);for(var v=0;v<a.childNodes.length;v++)x(a.childNodes.item(v))};if(e instanceof NodeList)for(var n=0;n<e.length;n++)x(e.item(n));else{if(!(e instanceof Node))throw new Error("Element must be a DOM Node or NodeList instance.");x(e)}},View.prototype.createHandler=function(node,event,code){var me=this;node.id;var regex=new RegExp("[(].*[)]");return code.toLowerCase().startsWith("this.controller.")&&!regex.test(code)?e=>{e.preventDefault();var f=eval(code);f.call(me.controller,e)}:function(e){"click"!==event&&"dblclick"!==event||e.preventDefault(),new Function(code).call(me)}},View.prototype.createListener=function(e,o){var r,t;0<e.lastIndexOf(".")&&(t=e.substr(0,e.lastIndexOf(".")),r=e.substr(e.lastIndexOf(".")+1),(e=new Function("return "+t).call(this))&&e.addChangeListener&&e.addChangeListener instanceof Function&&e.addChangeListener(r,function(e,t,n){o.value=n}),0<t.lastIndexOf(".")&&"this.controller"!==t&&"this.controller.model"!==t&&(e=t.substr(0,t.lastIndexOf(".")),(e=new Function("return "+e).call(this))&&e.addChangeListener&&e.addChangeListener instanceof Function&&(t=t.substr(t.lastIndexOf(".")+1),e.addChangeListener(t,function(e,t,n){o.value=n?n[r]:null,o.onchange=function(){n[r]=o.value}}))))},View.prototype.createTextBinding=function(e,o){var r,t;0<e.lastIndexOf(".")&&(t=e.substr(0,e.lastIndexOf(".")),r=e.substr(e.lastIndexOf(".")+1),(e=new Function("return "+t).call(this))&&e.addChangeListener&&e.addChangeListener instanceof Function&&e.addChangeListener(r,function(e,t,n){o.textContent=n}),0<t.lastIndexOf(".")&&"this.controller"!==t&&"this.controller.model"!==t&&(e=t.substr(0,t.lastIndexOf(".")),(e=new Function("return "+e).call(this))&&e.addChangeListener&&e.addChangeListener instanceof Function&&(t=t.substr(t.lastIndexOf(".")+1),e.addChangeListener(t,function(e,t,n){o.textContent=n?n[r]:""}))))},View.prototype.filter=function(e,t){return"Date"!==e?this.controller.hasOwnProperty(e)&&this.controller[e]instanceof Function?this.controller[e](t):t:!t||t.trim&&""===t.trim()?"":((e=new Date).setTime(t),e.toLocaleDateString("de-DE"))},View.prototype.render=function(e,t,n){if(!t)return this.replace(e,{});if(-1<e.indexOf(attrPrefix)){-1<e.indexOf(expPrefix)&&(e=this.replace(e,t));var o=document.createElement("DIV");return o.innerHTML=e,this.process(o,t,n),o.childNodes}return-1===e.indexOf(attrPrefix)?-1<e.indexOf(expPrefix)?this.replace(e,t,!1):e:void 0},View.prototype.replace=function(e,t,n){if(""===e.trim())return e;var o=e,r=e.match(/(\{{.+?\}})/g);if(r&&0<r.length)for(var i=0;i<r.length;i++){var a=r[i],s=a.substr(2,a.length-4),c=void 0;-1<s.indexOf("|")&&(s=s.substr(0,s.indexOf("|")),c=a.substr(a.indexOf("|")+1,a.length-3-a.indexOf("|")));var u="";t.hasOwnProperty(s)?(u=t[s]||"",c&&(u=this.filter(c,u)),o=o.replace(a,!0===n?'<span ae-model="'+s+'">'+u+"</span>":u)):-1<s.indexOf(".")&&(u=new Function("try { return this."+s+'; } catch (ex) { return "{{'+s+'}}";} ').call(t),o=o.replace(a,u))}return o},View.prototype.getEl=function(){if(this.element=document.querySelector(this.elementName),void 0===this.element)throw new Error("Element not found for selector: "+name);return this.element},this.view=function(e){return views[e]||(views[e]=new View(e)),views[e]};var Router=function(e){var t=this;this.root=e.root||null,this.useHash=e.useHash||!1,this.routes={},this.defaultHandler=void 0,window.addEventListener("DOMContentLoaded",function(){t.init()})};Router.prototype.default=function(e){if(!(e instanceof Function))throw new Error("The default route handler must be a function.");this.defaultHandler=e},Router.prototype.init=function(){var t=this;window.onhashchange=function(e){t.onhashchange.apply(t,[e])},window.onload=function(e){t.onhashchange.apply(t,[e])}},Router.prototype.on=function(e,t){if(!(t instanceof Function))throw new Error("Handler needs to be a function.");this.routes[e]=t},Router.prototype.onError=function(e){if(!(e instanceof Function))throw new Error("The default error handler must be a function.");this.errorHandler=e},Router.prototype.onhashchange=function(e){var t=window.location.href,n="";"load"===e.type?0<t.indexOf("#")&&(n=t.substr(t.indexOf("#")+1)):0<e.newURL.indexOf("#")&&(n=e.newURL.substr(e.newURL.indexOf("#")+1)),this.navigate(n)},Router.prototype.navigate=function(e){var t,n=this.routes[e=""===e?"/":e];if(this.params=t,void 0===n)for(var o in this.routes)if(0<o.indexOf(":")){var r=o.split("/"),i=e.split("/");try{if(i.length===r.length){t={},this.params=t;for(var a=0;a<r.length;a++)if(":"===r[a].charAt(0))t[r[a].substr(1)]=i[a];else if(i[a]!==r[a])throw t=void 0,new Error("not matching!");n=this.routes[o];break}}catch(e){continue}}if(void 0===(n=void 0===n?this.defaultHandler:n)){if(this.errorHandler)return void this.errorHandler({url:e});throw new Error("No handler for route: "+e)}if(!(n instanceof Function))throw new Error("Handler is not a function.");n(t?{params:t}:void 0)},this.router=function(e,t){return new Router({root:e,useHash:t})}});
//# sourceMappingURL=ae-ultraslim.map