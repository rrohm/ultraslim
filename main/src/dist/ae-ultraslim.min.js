!function(){"use strict";var e=window.æ||new function(){this.templates={};var m="ae-",y="{{",n={},r=this;function t(e){this.controller=void 0,this.init(e)}function o(e){var n=this;this.root=e.root||null,this.useHash=e.useHash||!1,this.routes={},this.defaultHandler=void 0,window.addEventListener("DOMContentLoaded",function(){n.init()})}this.templates.load=function(e){var n=this,t=new XMLHttpRequest,o="string"==typeof e?e:e.url,r="object"==typeof e?e:void 0;this.cache[o]?(e=this.cache[o],n.onDone&&n.onDone instanceof Function&&n.onDone(e,r)):(t.addEventListener("load",function(){var e=t.responseText;t.status<300?(n.onLoad&&n.onLoad instanceof Function&&(e=n.onLoad(e)||e),n.cache[o]=e,n.onDone&&n.onDone instanceof Function&&n.onDone(e,r)):n.onError&&n.onError instanceof Function&&n.onError(r)}),t.addEventListener("error",function(){n.onError&&n.onError instanceof Function&&n.onError(r)}),t.open("GET",o),t.send())},this.templates.onLoad=void 0,this.templates.onError=void 0,this.templates.onDone=function(e){return e},this.templates.cache={},this.service=function(r,i,e){if(void 0===r||"object"!=typeof r||"object"!=typeof r)throw new Error("o is not an object.");if(void 0===e||"object"!=typeof e)throw new Error("No configuration object.");if(void 0!==e.onError&&"function"!=typeof e.onError)throw new Error("onError-handler is not a function.");if(void 0!==e.onBeforeSend&&"function"!=typeof e.onBeforeSend)throw new Error("onBeforeSend-handler is not a function.");if(void 0!==e.onDone&&"function"!=typeof e.onDone)throw new Error("onDone-handler is not a function.");r.hasOwnProperty(i)||(r[i]=[],this.object(r));var a={},s="string"==typeof e?e:e.url;function c(e,n){e&&e.onBeforeSend&&e.onBeforeSend instanceof Function?e.onBeforeSend(n):a.onBeforeSend&&a.onBeforeSend(n)}function u(e,n){var t,o;n.status<400?(o=n,(t=e)&&t.onSuccess&&t.onSuccess instanceof Function?t.onSuccess(o.status,o):a.onSuccess&&a.onSuccess(o.status,o)):(t=n,(o=e)&&o.onError&&o.onError instanceof Function?o.onError(t.status,t):a.onError&&a.onError(t.status,t)),e&&e.onDone&&e.onDone instanceof Function?e.onDone(n.status,n):a.onDone&&a.onDone(n)}return(a={}).dataProp=void 0!==e.dataProp?e.dataProp:void 0,a.onError="function"==typeof e.onError?e.onError:void 0,a.onBeforeSend="function"==typeof e.onBeforeSend?e.onBeforeSend:void 0,a.onSuccess="function"==typeof e.onSuccess?e.onSuccess:void 0,a.onDone="function"==typeof e.onDone?e.onDone:void 0,a.load=function(t){var o=new XMLHttpRequest;o.addEventListener("load",function(e){var n;o.status<400&&(n=JSON.parse(o.responseText),r[i]=void 0!==a.dataProp?n[a.dataProp]:n),u(t,o)}),o.open("GET",s),o.setRequestHeader("X-Requested-With","XMLHttpRequest"),c(t,o),o.send()},a.delete=function(e,n){var t=new XMLHttpRequest;t.addEventListener("load",function(){u(n,t)}),t.open("DELETE",s+"/"+e),t.setRequestHeader("Content-Type","application/json"),t.setRequestHeader("X-Requested-With","XMLHttpRequest"),c(n,t),t.send()},a.create=function(e,n){var t=new XMLHttpRequest;t.addEventListener("load",function(){u(n,t)}),t.open("POST",s),t.setRequestHeader("Content-Type","application/json"),t.setRequestHeader("X-Requested-With","XMLHttpRequest"),c(n,t),t.send(JSON.stringify(e))},a.save=function(e,n){var t=new XMLHttpRequest;t.addEventListener("load",function(){u(n,t)}),t.open("PUT",s),t.setRequestHeader("Content-Type","application/json"),t.setRequestHeader("X-Requested-With","XMLHttpRequest"),c(n,t),t.send(JSON.stringify(e))},a},this.object=function(i){var a=this,e=[],s={};if(i){for(var t in s.size=function(){var e,n=0,t=Object.getOwnPropertyNames(s);for(e in t)"length"!==t[e]&&"size"!==t[e]&&n++;return n},i)i[t],i[t]instanceof Function||"http"===t&&t.get&&t.put&&t.delete&&t.post||(e[t]=i[t],delete i[t],Object.defineProperty(i,t,{get:function(e,n){return function(){return e[n]}}(e,t),set:function(o,r){return function(t){Array.isArray(t)?(a.object(t),t.push=function(e){if(Array.prototype.push.call(t,e),s[r])for(var n in s[r])s[r][n](i,null,t)}):"object"==typeof t&&a.object(t);var e=o[r];if(o[r]=t,s[r])for(var n in s[r])s[r][n](i,e,t)}}(e,t),enumerable:!0,configurable:!0}),Array.isArray(i[t])?(this.object(i[t]),i[t].push=function(e){if(i[t],Array.prototype.push.call(i[t],e),s[t])for(var n in a.object(e),s[t])s[t][n](i,null,e)}):"object"==typeof i[t]&&this.object(i[t]));for(var n in i.addChangeListener,i.addChangeListener=function(e,n){s[e]||(s[e]=[]),s[e].push(n)},i.getChangeListeners=function(){return s},i.clearChangeListeners=function(){s={size:function(){var e,n=0,t=Object.getOwnPropertyNames(s);for(e in t)"length"!==t[e]&&"size"!==t[e]&&n++;return n}}},i.fireChangeListeners=function(){var e,n=Object.getOwnPropertyNames(s);for(e in n)if("length"!==n[e]&&"size"!==n[e]&&s[n[e]].length)for(var t=0;t<s[n[e]].length;t++)"function"==typeof s[n[e]][t]&&s[n[e]][t](i,i[n[e]],i[n[e]])},i)"object"==typeof i[n]&&i.addChangeListener(n,function(e,n,t){if(n&&n.getChangeListeners){t.addChangeListener||a.object(t);var o,r=n.getChangeListeners();for(o in r)if("size"!==o&&r[o].length)for(var i=0;i<r[o].length;i++)t.addChangeListener(o,r[o][i])}})}},t.prototype.init=function(e){if(this.elementName=e,this.element=document.querySelector(this.elementName),void 0===this.element)throw new Error("Element not found for selector: "+e);var o=this;r.templates.onDone=function(e,n){var t=n&&n.controller&&n.controller.model?n.controller.model:void 0;t&&"object"==typeof t&&r.object(t),n=n&&n.controller?n.controller:void 0,o.onLoad(e,t,n)}},t.prototype.show=function(e,n){(this.controller=n)&&n.model&&"object"==typeof n.model&&(n.model,r.object(n.model)),r.templates.load(n?{url:e,controller:n}:e)},t.prototype.onLoad=function(e,n,t){if((e=void 0!==n?this.render(e,n,t):e)instanceof NodeList){this.getEl().innerHTML="";for(var o=0;o<e.length;o++)this.getEl().appendChild(e.item(o))}else this.getEl().innerHTML=e;t&&"function"==typeof t.init&&t.init(this.getEl())},t.prototype.onError=function(e){},t.prototype.process=function(e,p,n){var v,g=this,w=function(a){if(1===a.nodeType){for(var s=a.parentNode,e=0;e<a.attributes.length;e++)-1<(v=a.attributes.item(e)).value.indexOf(y)&&(v.value=g.replace(v.value,p));for(var n,t,o,r=0;r<a.attributes.length;r++)if((v=a.attributes.item(r)).name===m+"repeat"){if(p[v.value]){var i=p[v.value],c=[];if(0<i.length){for(var u=0;u<i.length;u++){var f=i[u],d=a.cloneNode(!0);d.attributes.removeNamedItem(m+"repeat"),g.process(d,f),c.push(d)}for(var l=0;l<c.length;l++)a.parentNode.insertBefore(c[l],a)}p.addChangeListener&&p.addChangeListener(v.value,function(e,n,t){if(s.innerHTML="",0<t.length)for(var o=0;o<t.length;o++){var r=t[o],i=a.cloneNode(!0);i.attributes.removeNamedItem(m+"repeat"),g.process(i,r),s.appendChild(i)}})}a.parentNode.removeChild(a)}else v.name===m+"click"?(v.value,a.onclick=g.createHandler(a,"click",v.value)):v.name===m+"bind"&&(v.value,n=v.value,t=new Function("return "+n).call(g),a.value=t,0<n.lastIndexOf(".")&&(t=n.substr(0,n.lastIndexOf(".")),o=new Function("return "+t).call(g),a.onchange=function(e){o[n.substr(n.lastIndexOf(".")+1)]=a.value}),g.createListener(n,a))}3===a.nodeType&&-1<a.nodeValue.indexOf(y)&&(a.nodeValue=g.replace(a.nodeValue,p),-1<a.nodeValue.indexOf("<b>")&&(a.innerHTML=a.nodeValue));for(var h=0;h<a.childNodes.length;h++)w(a.childNodes.item(h))};if(e instanceof NodeList)for(var t=0;t<e.length;t++)w(e.item(t));else{if(!(e instanceof Node))throw new Error("Element must be a DOM Node or NodeList instance.");w(e)}},t.prototype.createHandler=function(e,n,t){var o=this;return e.id,function(e){"click"===n&&e.preventDefault(),new Function(t).call(o)}},t.prototype.createListener=function(e,o){var r,n;0<e.lastIndexOf(".")&&(n=e.substr(0,e.lastIndexOf(".")),r=e.substr(e.lastIndexOf(".")+1),(e=new Function("return "+n).call(this))&&e.addChangeListener&&e.addChangeListener instanceof Function&&e.addChangeListener(r,function(e,n,t){o.value=t}),0<n.lastIndexOf(".")&&"this.controller"!==n&&"this.controller.model"!==n&&(e=n.substr(0,n.lastIndexOf(".")),(e=new Function("return "+e).call(this))&&e.addChangeListener&&e.addChangeListener instanceof Function&&(n=n.substr(n.lastIndexOf(".")+1),e.addChangeListener(n,function(e,n,t){o.value=t?t[r]:null,o.onchange=function(){t[r]=o.value}}))))},t.prototype.filter=function(e,n){return"Date"!==e?this.controller.hasOwnProperty(e)&&this.controller[e]instanceof Function?this.controller[e](n):n:!n||n.trim&&""===n.trim()?"":((e=new Date).setTime(n),e.toLocaleDateString("de-DE"))},t.prototype.render=function(e,n,t){if(!n)return this.replace(e,{});if(-1<e.indexOf(m)){var o=document.createElement("DIV");return o.innerHTML=e,this.process(o,n,t),o.childNodes}return-1===e.indexOf(m)?-1<e.indexOf(y)?this.replace(e,n):e:void 0},t.prototype.replace=function(e,n){if(""===e.trim())return e;var t=e,o=e.match(/(\{{.+?\}})/g);if(o&&0<o.length)for(var r=0;r<o.length;r++){var i=o[r],a=i.substr(2,i.length-4),s=void 0;-1<a.indexOf("|")&&(a=a.substr(0,a.indexOf("|")),s=i.substr(i.indexOf("|")+1,i.length-3-i.indexOf("|")));var c="";n.hasOwnProperty(a)?(c=n[a]||"",s&&(c=this.filter(s,c)),t=t.replace(i,c)):-1<a.indexOf(".")&&(c=new Function("try { return this."+a+'; } catch (ex) { return "{{'+a+'}}";} ').call(n),t=t.replace(i,c))}return t},t.prototype.getEl=function(){if(this.element=document.querySelector(this.elementName),void 0===this.element)throw new Error("Element not found for selector: "+name);return this.element},this.view=function(e){return n[e]||(n[e]=new t(e)),n[e]},o.prototype.default=function(e){if(!(e instanceof Function))throw new Error("The default route handler must be a function.");this.defaultHandler=e},o.prototype.init=function(){var n=this;window.onhashchange=function(e){n.onhashchange.apply(n,[e])},window.onload=function(e){n.onhashchange.apply(n,[e])}},o.prototype.on=function(e,n){if(!(n instanceof Function))throw new Error("Handler needs to be a function.");this.routes[e]=n},o.prototype.onError=function(e){if(!(e instanceof Function))throw new Error("The default error handler must be a function.");this.errorHandler=e},o.prototype.onhashchange=function(e){var n=window.location.href,t="";"load"===e.type?0<n.indexOf("#")&&(t=n.substr(n.indexOf("#")+1)):0<e.newURL.indexOf("#")&&(t=e.newURL.substr(e.newURL.indexOf("#")+1)),this.navigate(t)},o.prototype.navigate=function(e){var n,t=this.routes[e=""===e?"/":e];if(this.params=n,void 0===t)for(var o in this.routes)if(0<o.indexOf(":")){var r=o.split("/"),i=e.split("/");try{if(i.length===r.length){n={},this.params=n;for(var a=0;a<r.length;a++)if(":"===r[a].charAt(0))n[r[a].substr(1)]=i[a];else if(i[a]!==r[a])throw n=void 0,new Error("not matching!");t=this.routes[o];break}}catch(e){continue}}if(void 0===(t=void 0===t?this.defaultHandler:t)){if(this.errorHandler)return void this.errorHandler({url:e});throw new Error("No handler for route: "+e)}if(!(t instanceof Function))throw new Error("Handler is not a function.");t(n?{params:n}:void 0)},this.router=function(e,n){return new o({root:e,useHash:n})}};window.æ=window.ultraslim=e}();
//# sourceMappingURL=ae-ultraslim.map